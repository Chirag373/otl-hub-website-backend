<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}OTL Platform{% endblock %}</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>


    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.23/dist/full.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@2.0.4"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['sans-serif'],
                        heading: ['sans-serif'],
                        body: ['sans-serif'],
                    },
                    colors: {
                        border: "var(--border)",
                        input: "var(--input)",
                        ring: "var(--ring)",
                        background: "var(--background)",
                        foreground: "var(--foreground)",
                        primary: {
                            DEFAULT: "var(--primary)",
                            foreground: "var(--primary-foreground)",
                        },
                        secondary: {
                            DEFAULT: "var(--secondary)",
                            foreground: "var(--secondary-foreground)",
                        },
                        muted: {
                            DEFAULT: "var(--muted)",
                            foreground: "var(--muted-foreground)",
                        },
                        accent: {
                            DEFAULT: "var(--accent)",
                            foreground: "var(--accent-foreground)",
                            hover: "var(--accent-hover)",
                        },
                        card: {
                            DEFAULT: "var(--card)",
                            foreground: "var(--card-foreground)",
                        },
                        destructive: {
                            DEFAULT: "var(--destructive)",
                            foreground: "var(--destructive-foreground)",
                        },
                    },
                    borderRadius: {
                        lg: "var(--radius)",
                        md: "calc(var(--radius) - 2px)",
                        sm: "calc(var(--radius) - 4px)",
                    },
                }
            }
        }
    </script>

    <style>
        :root {
            --radius: 0.625rem;
            --bg: #2a2a2a;
            --card: #3a3a3a;
            --muted: #c0c0c0;
            --accent: #d4af37;
            --accent-hover: #e0c066;
            --border: #4a4a4a;

            /* Dark theme mappings */
            --background: #2a2a2a;
            --foreground: #f3f4f6;
            --card-foreground: #f3f4f6;
            --popover: #3a3a3a;
            --popover-foreground: #f3f4f6;
            --primary: #d4af37;
            --primary-foreground: #2a2a2a;
            --secondary: #464646;
            --secondary-foreground: #f3f4f6;
            --muted: #464646;
            --muted-foreground: #c0c0c0;
            --accent-foreground: #2a2a2a;
            --destructive: #dc2626;
            --input: #464646;
            --ring: #d4af37;
        }

        body {
            background-color: var(--bg);
            color: var(--foreground);
            font-family: sans-serif;
            font-size: 16px;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .font-heading {
            font-family: sans-serif;
            font-weight: 600;
        }

        /* Blur effect for features list */
        .blur-text {
            filter: blur(2px);
            user-select: none;
            opacity: 0.6;
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>

<body class="min-h-screen flex flex-col">

    {% include 'partials/header.html' %}

    <main class="pt-16 flex-1">
        {% block content %}
        {% endblock %}
    </main>

    {% include 'partials/footer.html' %}

    <!-- Login Modal -->
    <div id="login-modal"
        class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-[var(--card)] rounded-lg shadow-2xl max-w-sm w-full border border-[var(--border)] overflow-hidden scale-95 opacity-0 transition-all duration-200"
            id="login-modal-content">
            <div class="p-6 relative text-center">
                <button onclick="closeLoginModal()"
                    class="absolute top-4 right-4 text-[var(--muted-foreground)] hover:text-[var(--foreground)] transition-colors">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
                <div
                    class="w-16 h-16 bg-[var(--accent)]/10 rounded-full flex items-center justify-center mb-4 mx-auto text-[var(--accent)]">
                    <i data-lucide="lock" class="w-8 h-8"></i>
                </div>
                <h3 id="login-modal-title" class="text-2xl font-bold text-[var(--foreground)]">Login Required</h3>
                <p id="login-modal-desc" class="text-[var(--muted-foreground)] mt-2 mb-6">You must be logged in to
                    unlock property details and
                    view seller information.</p>

                <div class="flex flex-col gap-3">
                    <a href="{% url 'login' %}?next={{ request.get_full_path }}"
                        class="btn btn-primary bg-[var(--accent)] text-[var(--bg)] border-none hover:bg-[var(--accent-hover)] w-full">
                        Log In
                    </a>
                    <a href="{% url 'signup' %}"
                        class="btn btn-outline border-[var(--border)] text-[var(--foreground)] hover:bg-[var(--muted)] w-full">
                        Create an Account
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        const isUserAuthenticatedGlobal = "{{ user.is_authenticated|yesno:'true,false' }}" === "true";

        function openLoginModal(title, message) {
            const modal = document.getElementById('login-modal');
            const content = document.getElementById('login-modal-content');
            const titleEl = document.getElementById('login-modal-title');
            const descEl = document.getElementById('login-modal-desc');

            // Default text
            const defaultTitle = "Login Required";
            const defaultDesc = "You must be logged in to unlock property details and view seller information.";

            if (titleEl) titleEl.textContent = title || defaultTitle;
            if (descEl) descEl.textContent = message || defaultDesc;

            if (modal && content) {
                modal.classList.remove('hidden');
                setTimeout(() => {
                    content.classList.remove('scale-95', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                }, 10);
            }
        }

        function closeLoginModal() {
            const modal = document.getElementById('login-modal');
            const content = document.getElementById('login-modal-content');
            if (modal && content) {
                content.classList.remove('scale-100', 'opacity-100');
                content.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 200);
            }
        }

        // Close modal on outside click
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('login-modal');
            if (e.target === modal) closeLoginModal();
        });
    </script>


    <script>
        lucide.createIcons();
    </script>
    {% block extra_scripts %}{% endblock %}
</body>

</html>